(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{320:function(t,a,s){t.exports=s.p+"assets/img/request.b6425cf1.png"},321:function(t,a,s){t.exports=s.p+"assets/img/block.e60fb9b2.png"},322:function(t,a,s){t.exports=s.p+"assets/img/config.793157f4.png"},323:function(t,a,s){t.exports=s.p+"assets/img/entry.3958f8ee.jpeg"},324:function(t,a,s){t.exports=s.p+"assets/img/dashboard.d45cf173.jpeg"},325:function(t,a,s){t.exports=s.p+"assets/img/turbine.e5970924.png"},326:function(t,a,s){t.exports=s.p+"assets/img/entry2.5e4518c0.jpeg"},327:function(t,a,s){t.exports=s.p+"assets/img/topology.a28487a3.png"},328:function(t,a,s){t.exports=s.p+"assets/img/jmeter1.6692b883.jpeg"},329:function(t,a,s){t.exports=s.p+"assets/img/jmeter2.8de72b3d.jpeg"},330:function(t,a,s){t.exports=s.p+"assets/img/jmeter3.7a49d13b.jpeg"},331:function(t,a,s){t.exports=s.p+"assets/img/dashboard2.01f1fb13.jpeg"},403:function(t,a,s){"use strict";s.r(a);var n=s(5),r=Object(n.a)({},function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"一、背景：微服务调用雪崩效应"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、背景：微服务调用雪崩效应","aria-hidden":"true"}},[t._v("#")]),t._v(" 一、背景：微服务调用雪崩效应")]),t._v(" "),n("p",[n("img",{attrs:{src:s(320),alt:"图片",title:"图片"}}),t._v("\n注：在上图中表示容器里有一个处理用户请求的线程，它依赖A、H、I、P这几个服务，由于I服务出现了问题，导致用户请求线程挂起，无法再处理其它请求。")]),t._v(" "),n("p",[n("img",{attrs:{src:s(321),alt:"图片",title:"图片"}}),t._v("\n注：")]),t._v(" "),n("ul",[n("li",[t._v("上图中，假设最上层用户请求处理线程有n个，这n个线程很可能都由于I服务的异常，导致挂起等待。这时候整个系统完全无法处理任何其它请求，即使其它请求不依赖I服务，即使其它请求（如果被处理）可以快速得到响应。其结果称为雪崩效应")]),t._v(" "),n("li",[t._v("熔断限流降级正是避免雪崩效应的解决方案。")]),t._v(" "),n("li",[t._v("而Hystrix是Netflix公司推出的业界知名的熔断限流降级解决方案。")])]),t._v(" "),n("h2",{attrs:{id:"二、原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、原理","aria-hidden":"true"}},[t._v("#")]),t._v(" 二、原理")]),t._v(" "),n("h3",{attrs:{id:"_1-hystrix如何解决依赖隔离"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-hystrix如何解决依赖隔离","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. Hystrix如何解决依赖隔离")]),t._v(" "),n("p",[n("img",{attrs:{src:s(322),alt:"图片",title:"图片"}})]),t._v(" "),n("ul",[n("li",[t._v("Hystrix使用命令模式包装依赖调用逻辑，每个命令在单独线程中执行。")]),t._v(" "),n("li",[t._v("提供小线程池，如果线程池已满调用将被立即拒绝。")]),t._v(" "),n("li",[t._v("依赖调用结果分:成功，失败（抛出异常，超时，线程拒绝，短路）。 请求失败时执行fallback(降级)逻辑。")]),t._v(" "),n("li",[t._v("提供熔断器组件,可以自动运行或手动调用,停止当前依赖一段时间(10秒)，熔断器默认错误率阈值为50%,超过将自动运行。")]),t._v(" "),n("li",[t._v("提供近实时依赖的统计和监控")])]),t._v(" "),n("h3",{attrs:{id:"_2-熔断条件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-熔断条件","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 熔断条件")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("总调用次数 = 成功次数+失败次数+超时次数+拒绝次数")])]),t._v(" "),n("li",[n("p",[t._v("失败率 =（失败次数+超时次数+拒绝次数） ÷ 总调用次数")])]),t._v(" "),n("li",[n("p",[t._v("配置失败率阈值（默认50%）：")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("  circuitBreaker.errorThresholdPercentage = 60\n")])])]),n("ul",[n("li",[n("p",[t._v("熔断条件：")]),t._v(" "),n("p",[t._v("失败率 > 配置失败率阈值  且10秒内超过20个请求")])])]),t._v(" "),n("h3",{attrs:{id:"_3-熔断、限流、降级关系"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-熔断、限流、降级关系","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 熔断、限流、降级关系")]),t._v(" "),n("p",[t._v("Hystrix实现时首先对每个接口设置了一个默认10个线程的线程池来处理所有接口请求，其次还设置了默认为5的拒绝等待队列大小阈值。")]),t._v(" "),n("ul",[n("li",[t._v("限流：当所有线程都忙，而且等待请求队列中请求数量达到阈值时，限流就发生了。在此情况下，还有新请求进来，将不再排队，直接因限流而拒绝。")]),t._v(" "),n("li",[t._v("熔断：当最近一段时间（具体时长可配置）内，满足熔断条件时，熔断发生，这时候，新请求不再处理，直接因熔断而拒绝。")]),t._v(" "),n("li",[t._v("降级：当出现下述场景时，将执行consumer端默认接口实现来代替原来provider提供的接口服务，该过程称为降级：\n"),n("ul",[n("li",[n("p",[t._v("（1）限流")])]),t._v(" "),n("li",[n("p",[t._v("（2）熔断")])]),t._v(" "),n("li",[n("p",[t._v("（3）超时")])]),t._v(" "),n("li",[n("p",[t._v("（4）provider返回http状态码为5xx的响应（这种原因，我们简单记为：失败）")])])])])]),t._v(" "),n("p",[t._v("注：")]),t._v(" "),n("ul",[n("li",[t._v("总调用次数 = 成功次数+失败次数+超时次数+拒绝次数")])]),t._v(" "),n("p",[t._v("这个公式中的失败次数指provier返回http状态码为5xx的响应次数，拒绝次数包含因限流和熔断两种因素导致的拒绝次数")]),t._v(" "),n("ul",[n("li",[t._v("限流时，可能熔断还没发生（还没到熔断条件）")]),t._v(" "),n("li",[t._v("熔断时，严格来说新请求也不是都拒绝，而是有一定的算法来逐步放行请求，看provider微服务是否恢复了。具体恢复条件是：")])]),t._v(" "),n("p",[t._v("熔断暂停一段时间（默认是5s）之后，允许部分请求通过，若请求都是健康的（响应时间<250ms）则对请求健康恢复（取消熔断），如果还不是健康的，则继续熔断。")]),t._v(" "),n("h2",{attrs:{id:"三、实战准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、实战准备工作","aria-hidden":"true"}},[t._v("#")]),t._v(" 三、实战准备工作")]),t._v(" "),n("h3",{attrs:{id:"_1-docker-容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-docker-容器","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. "),n("router-link",{attrs:{to:"/2018/08/24/玩转docker/"}},[t._v("docker & 容器")])],1),t._v(" "),n("h3",{attrs:{id:"_2-consul注册发现服务中心"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-consul注册发现服务中心","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. "),n("router-link",{attrs:{to:"/2018/08/26/服务注册发现consul起步/"}},[t._v("consul注册发现服务中心")])],1),t._v(" "),n("h3",{attrs:{id:"_3-provider微服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-provider微服务","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. "),n("router-link",{attrs:{to:"/2018/08/29/Provider微服务实战/"}},[t._v("Provider微服务")])],1),t._v(" "),n("h3",{attrs:{id:"_4-consumer微服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-consumer微服务","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. "),n("router-link",{attrs:{to:"/2018/08/31/Consumer微服务实战/"}},[t._v("Consumer微服务")])],1),t._v(" "),n("h2",{attrs:{id:"四、feign启用hystrix实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、feign启用hystrix实战","aria-hidden":"true"}},[t._v("#")]),t._v(" 四、Feign启用Hystrix实战")]),t._v(" "),n("h3",{attrs:{id:"_1-consumer微服务增加hystrix支持"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-consumer微服务增加hystrix支持","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. consumer微服务增加Hystrix支持")]),t._v(" "),n("h4",{attrs:{id:"（1）增加hystrix依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（1）增加hystrix依赖","aria-hidden":"true"}},[t._v("#")]),t._v(" （1）增加hystrix依赖")]),t._v(" "),n("p",[t._v("pom.xml:")]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.cloud"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-cloud-starter-netflix-hystrix"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h4",{attrs:{id:"（2）启用hystrix，并开放hystrix-stream-metrics"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（2）启用hystrix，并开放hystrix-stream-metrics","aria-hidden":"true"}},[t._v("#")]),t._v(" （2）启用hystrix，并开放hystrix.stream metrics")]),t._v(" "),n("p",[t._v("src/main/resources/application.properties:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("feign.hystrix.enabled = true\nmanagement.endpoints.web.exposure.include = health,info,hystrix.stream\n")])])]),n("p",[t._v("注：上述配置")]),t._v(" "),n("ul",[n("li",[t._v("第一句配置启用feign的hystrix功能")]),t._v(" "),n("li",[t._v("第二句暴露hystrix统计接口，以便后续hystrix dashboard或turbine可以从这个接口抓取接口调用统计信息并展示")])]),t._v(" "),n("h4",{attrs:{id:"（3）启用熔断注解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（3）启用熔断注解","aria-hidden":"true"}},[t._v("#")]),t._v(" （3）启用熔断注解")]),t._v(" "),n("p",[t._v("src/main/java/com/example/consumer/ConsumerApplication.java：")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SpringBootApplication")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableDiscoveryClient")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableFeignClients")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableCircuitBreaker")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsumerApplication")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsumerApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("注： @EnableCircuitBreaker启用了熔断功能")]),t._v(" "),n("h4",{attrs:{id:"（4）配置feignclient失败回调"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（4）配置feignclient失败回调","aria-hidden":"true"}},[t._v("#")]),t._v(" （4）配置FeignClient失败回调")]),t._v(" "),n("p",[t._v("src/main/java/com/example/consumer/ProviderInterface.java：")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@FeignClient")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"provider"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fallback "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderFallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderInterface")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestMapping")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/test"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" method "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" consumes "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderPOJO")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v('”name"'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"（5）降级实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（5）降级实现","aria-hidden":"true"}},[t._v("#")]),t._v(" （5）降级实现")]),t._v(" "),n("p",[t._v("src/main/java/com/example/consumer/ProviderFallback.java：")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderFallback")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderInterface")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderPOJO")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("注：这里简单返回null，具体实践中，也可以根据情况返回别的默认值或者错误信息")]),t._v(" "),n("h4",{attrs:{id:"（6）hystrix部分配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（6）hystrix部分配置","aria-hidden":"true"}},[t._v("#")]),t._v(" （6）hystrix部分配置")]),t._v(" "),n("p",[t._v("src/main/resources/application.properties:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("# 线程池大小\nhystrix.threadpool.default.coreSize=20\n# 拒绝请求队列大小\nhystrix.threadpool.default.queueSizeRejectionThreshold=20\n# 超时时间\nhystrix.command.default.execution.isolation.thread.timeoutInMilliseconds=1000\n")])])]),n("p",[t._v("注：")]),t._v(" "),n("p",[t._v("更多配置参考"),n("a",{attrs:{href:"https://github.com/Netflix/Hystrix/wiki/Configuration",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网"),n("OutboundLink")],1),t._v("文档.\n另外上述配置是默认配置，对所有接口都适用，也可以单独配置某个接口hystrix参数，具体见官网文档")]),t._v(" "),n("h3",{attrs:{id:"_2-provider微服务模拟失败"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-provider微服务模拟失败","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. provider微服务模拟失败")]),t._v(" "),n("p",[t._v("src/main/java/com/example/provider/ProviderController.java：")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("lombok"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extern"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slf4j")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Slf4j")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beans"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RequestMapping")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RequestParam")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestController")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("atomic")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicLong")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @Author: yangjianguang\n * @Date: 2018/8/27\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RestController")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Slf4j")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderController")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicLong")]),t._v(" counter "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicLong")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${server.port}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" port"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestMapping")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/test"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderPOJO")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestParam")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" defaultValue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"provider"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"io"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("equalsIgnoreCase")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"simulate io exception"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderPOJO")]),t._v(" providerPOJO "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProviderPOJO")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("incrementAndGet")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" port"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ProviderController:test(): "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" providerPOJO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" providerPOJO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("注：")]),t._v(" "),n("ul",[n("li",[t._v("test接口实现时，根据name参数值为io时抛出IOException异常，导致返回http状态码为5xx的响应，对consumer端hystrix来说就是失败")]),t._v(" "),n("li",[t._v("sleep 10秒钟，模拟provider处理时间")])]),t._v(" "),n("h3",{attrs:{id:"_3-测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-测试","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 测试")]),t._v(" "),n("h4",{attrs:{id:"启动服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动服务","aria-hidden":"true"}},[t._v("#")]),t._v(" 启动服务")]),t._v(" "),n("p",[t._v("启动consul，provider（端口8080），consumer（端口8090）")]),t._v(" "),n("h4",{attrs:{id:"模拟正常访问"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模拟正常访问","aria-hidden":"true"}},[t._v("#")]),t._v(" 模拟正常访问")]),t._v(" "),n("p",[t._v("浏览器正常访问：http://localhost:8090/test, 返回")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("583")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"consumer"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"port"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8090")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"providerPOJO"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("540")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"consumer"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"port"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"模拟异常访问"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模拟异常访问","aria-hidden":"true"}},[t._v("#")]),t._v(" 模拟异常访问")]),t._v(" "),n("p",[t._v("浏览器访问：http://localhost:8090/test?name=io,模拟provider返回失败：")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("585")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"io"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"port"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8090")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"providerPOJO"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("注：")]),t._v(" "),n("p",[t._v("从结果可以看出：由于provider失败，consumer调用了provider的降级实现，即providerPOJO返回null\n熔断测试参见下面Turbine实战部分")]),t._v(" "),n("h2",{attrs:{id:"五、hystrix-dashboard实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#五、hystrix-dashboard实战","aria-hidden":"true"}},[t._v("#")]),t._v(" 五、Hystrix Dashboard实战")]),t._v(" "),n("h3",{attrs:{id:"_1-创建名为hystrix-dashboard的module，选择依赖："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建名为hystrix-dashboard的module，选择依赖：","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 创建名为hystrix-dashboard的module，选择依赖：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("actuator， consul discovery， hystrix dashboard\n")])])]),n("h3",{attrs:{id:"_2-配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 配置")]),t._v(" "),n("p",[t._v("src/main/resources/application.properties：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("spring.application.name = hystrix-dashboard\n\nserver.port = ${PORT:9000}\n\nspring.cloud.consul.enabled = true\nspring.cloud.consul.host = ${CONSUL_HOST:127.0.0.1}\nspring.cloud.consul.port = 8500\nspring.cloud.consul.ribbon.enabled = true\nspring.cloud.consul.discovery.enabled = true\nspring.cloud.consul.discovery.register = true\nspring.cloud.consul.discovery.prefer-ip-address = true\nspring.cloud.consul.discovery.instance-id = ${spring.application.name}:${server.port}\n")])])]),n("h3",{attrs:{id:"_3-通过注解启用hystrix-dashboard"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-通过注解启用hystrix-dashboard","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 通过注解启用hystrix dashboard")]),t._v(" "),n("p",[t._v("src/main/java/com/example/hystrixashboard/HystrixDashboardApplication.java")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hystrixdashboard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("autoconfigure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringBootApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("netflix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hystrix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dashboard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EnableHystrixDashboard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SpringBootApplication")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableHystrixDashboard")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HystrixDashboardApplication")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HystrixDashboardApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"_4-测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-测试","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 测试")]),t._v(" "),n("h4",{attrs:{id:"（1）启动hystrix-dashboard，端口9000"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（1）启动hystrix-dashboard，端口9000","aria-hidden":"true"}},[t._v("#")]),t._v(" （1）启动hystrix-dashboard，端口9000")]),t._v(" "),n("h4",{attrs:{id:"（2）浏览器访问：-http-localhost-9000-hystrix"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（2）浏览器访问：-http-localhost-9000-hystrix","aria-hidden":"true"}},[t._v("#")]),t._v(" （2）浏览器访问： http://localhost:9000/hystrix")]),t._v(" "),n("p",[n("img",{attrs:{src:s(323),alt:"图片",title:"图片"}})]),t._v(" "),n("h4",{attrs:{id:"（3）在上述dashboard界面中输入如上图所示信息，点击monitor-stream，跳转dashboard仪表盘界面如下："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（3）在上述dashboard界面中输入如上图所示信息，点击monitor-stream，跳转dashboard仪表盘界面如下：","aria-hidden":"true"}},[t._v("#")]),t._v(" （3）在上述dashboard界面中输入如上图所示信息，点击Monitor Stream，跳转dashboard仪表盘界面如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:s(324),alt:"图片",title:"图片"}})]),t._v(" "),n("h4",{attrs:{id:"（4）浏览器访问：-http-localhost-8090-test-和-http-localhost-8090-test-name-io-，各刷新几次，观察dashboard仪表盘界面变化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（4）浏览器访问：-http-localhost-8090-test-和-http-localhost-8090-test-name-io-，各刷新几次，观察dashboard仪表盘界面变化","aria-hidden":"true"}},[t._v("#")]),t._v(" （4）浏览器访问： http://localhost:8090/test 和 http://localhost:8090/test?name=io ，各刷新几次，观察dashboard仪表盘界面变化")]),t._v(" "),n("h2",{attrs:{id:"六、turbine实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#六、turbine实战","aria-hidden":"true"}},[t._v("#")]),t._v(" 六、Turbine实战")]),t._v(" "),n("h3",{attrs:{id:"_1-原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-原理","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 原理")]),t._v(" "),n("p",[n("img",{attrs:{src:s(325),alt:"图片",title:"图片"}})]),t._v(" "),n("p",[t._v("注：")]),t._v(" "),n("ul",[n("li",[t._v("没有turbine，hystrix dashboard只能显示一个微服务的hystrix API调用统计信息，如上图的左下角部分")]),t._v(" "),n("li",[t._v("turbine是一个hystrix stream聚合器，它负责收集几个微服务的hystrix调用统计信息，再最终向hystrix dashboard提供数据")])]),t._v(" "),n("h3",{attrs:{id:"_2-创建名为turbine的module，选择依赖："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建名为turbine的module，选择依赖：","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 创建名为turbine的module，选择依赖：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("actuator， consul discovery， turbine\n")])])]),n("h3",{attrs:{id:"_3-配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 配置")]),t._v(" "),n("p",[t._v("src/main/resources/application.properties：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('spring.application.name = turbine\n\nserver.port = ${PORT:9001}\n\nmanagement.endpoints.web.exposure.include = health, info, turbine.stream\n\nspring.cloud.consul.enabled = true\nspring.cloud.consul.host = ${CONSUL_HOST:127.0.0.1}\nspring.cloud.consul.port = 8500\nspring.cloud.consul.ribbon.enabled = true\nspring.cloud.consul.discovery.enabled = true\nspring.cloud.consul.discovery.register = true\nspring.cloud.consul.discovery.prefer-ip-address = true\nspring.cloud.consul.discovery.instance-id = ${spring.application.name}:${server.port}\n\nturbine.app-config = consumer, other-microservice\nturbine.cluster-name-expression = new String("default")\nturbine.combine-host-port = true\n')])])]),n("p",[t._v("注：")]),t._v(" "),n("p",[t._v("turbine.app-config这个配置表明聚合哪些微服务的hystrix调用统计信息")]),t._v(" "),n("h3",{attrs:{id:"_4-注解启用turbine"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-注解启用turbine","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 注解启用Turbine")]),t._v(" "),n("p",[t._v("src/main/java/com/example/turbine/TurbineApplication.java")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("turbine")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("boot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("autoconfigure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringBootApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("netflix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("turbine")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EnableTurbine")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SpringBootApplication")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableTurbine")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TurbineApplication")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TurbineApplication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"_5-测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-测试","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. 测试")]),t._v(" "),n("h4",{attrs:{id:"（1）启动turbine-端口-9001"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（1）启动turbine-端口-9001","aria-hidden":"true"}},[t._v("#")]),t._v(" （1）启动turbine,端口:9001")]),t._v(" "),n("h4",{attrs:{id:"（2）浏览器访问hystrix-board：http-localhost-9000-hystrix，在界面中输入如下："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#（2）浏览器访问hystrix-board：http-localhost-9000-hystrix，在界面中输入如下：","aria-hidden":"true"}},[t._v("#")]),t._v(" （2）浏览器访问hystrix board：http://localhost:9000/hystrix，在界面中输入如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:s(326),alt:"图片",title:"图片"}})]),t._v(" "),n("p",[t._v("注：点击Monitor Stream后跳转到Hystrix Dashboard监控仪表盘，后续测试同上一节")]),t._v(" "),n("h2",{attrs:{id:"七-批量请求测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#七-批量请求测试","aria-hidden":"true"}},[t._v("#")]),t._v(" 七. 批量请求测试")]),t._v(" "),n("h3",{attrs:{id:"_1-启动consumer2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-启动consumer2","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 启动consumer2")]),t._v(" "),n("p",[t._v("按consumer模板，在Intellij IDEA中创建新的module：consumer2，设置hystrix线程池10个，熔断阈值80，并启动，端口8086")]),t._v(" "),n("h3",{attrs:{id:"_2-启动provider其它实例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动provider其它实例","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 启动provider其它实例")]),t._v(" "),n("p",[t._v("更改provider端口为8081，启动provider的另一个实例")]),t._v(" "),n("h3",{attrs:{id:"_3-更改module：turbine的配置文件如下，并重新启动："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-更改module：turbine的配置文件如下，并重新启动：","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 更改module：turbine的配置文件如下，并重新启动：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("turbine.app-config = consumer, consumer2\n")])])]),n("h3",{attrs:{id:"_4-这时网络拓扑图为："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-这时网络拓扑图为：","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 这时网络拓扑图为：")]),t._v(" "),n("p",[n("img",{attrs:{src:s(327),alt:"图片",title:"图片"}})]),t._v(" "),n("h3",{attrs:{id:"_5-启动jmeter，设置如下"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-启动jmeter，设置如下","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. 启动jmeter，设置如下")]),t._v(" "),n("p",[n("img",{attrs:{src:s(328),alt:"图片",title:"图片"}})]),t._v(" "),n("p",[t._v("注：这里设置了线程和发送请求的次数")]),t._v(" "),n("p",[n("img",{attrs:{src:s(329),alt:"图片",title:"图片"}})]),t._v(" "),n("p",[t._v("注：这里向端口为8090的consumer微服务发送请求，参数name，值io让provider返回失败")]),t._v(" "),n("p",[n("img",{attrs:{src:s(330),alt:"图片",title:"图片"}})]),t._v(" "),n("h3",{attrs:{id:"_6-启动jmeter测试，观察hystrix-dashboard熔断状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-启动jmeter测试，观察hystrix-dashboard熔断状态","aria-hidden":"true"}},[t._v("#")]),t._v(" 6. 启动jmeter测试，观察hystrix dashboard熔断状态")]),t._v(" "),n("p",[n("img",{attrs:{src:s(331),alt:"图片",title:"图片"}})]),t._v(" "),n("h3",{attrs:{id:"_7-设置jmeter的各种参数（如线程数量，loop次数，name参数值），观察hystrix-dashboard"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-设置jmeter的各种参数（如线程数量，loop次数，name参数值），观察hystrix-dashboard","aria-hidden":"true"}},[t._v("#")]),t._v(" 7. 设置jmeter的各种参数（如线程数量，loop次数，name参数值），观察hystrix dashboard")]),t._v(" "),n("h3",{attrs:{id:"_8-设置consumer中hystrix各种参数，重新运行jmeter测试，观察hystrix-dashboard"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-设置consumer中hystrix各种参数，重新运行jmeter测试，观察hystrix-dashboard","aria-hidden":"true"}},[t._v("#")]),t._v(" 8. 设置consumer中hystrix各种参数，重新运行jmeter测试，观察hystrix dashboard")]),t._v(" "),n("h2",{attrs:{id:"八、总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#八、总结","aria-hidden":"true"}},[t._v("#")]),t._v(" 八、总结")]),t._v(" "),n("ul",[n("li",[t._v("Hystrix：熔断、限流、降级")]),t._v(" "),n("li",[t._v("Hystrix Dashboard：API监控仪表盘")]),t._v(" "),n("li",[t._v("Turbine： API监控统计数据聚合")])]),t._v(" "),n("h2",{attrs:{id:"九、todo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#九、todo","aria-hidden":"true"}},[t._v("#")]),t._v(" 九、Todo")]),t._v(" "),n("p",[t._v("Hystrix默认只提供了接近实时的数据统计，以下功能需要二次开发：")]),t._v(" "),n("ul",[n("li",[t._v("保存查看历史统计数据")]),t._v(" "),n("li",[t._v("设置报警规则，并在监控到相关信息时自动报警")])])])},[],!1,null,null,null);a.default=r.exports}}]);